

#include "adc.h"
#include "uart.h"
#include <stdint.h>
#include <stdio.h>

static void ADC_Callback(void);

uint32_t sensor_value;
float voltage, tempC;

int main(void)
{
	Pa1_Adc_Interrupt_Init();
    UART2TX_Init();
    Start_Conversion_Conti();

    while(1)
    {

    }
}

static void ADC_Callback(void)
{
			sensor_value = ADC1->DR;

	        // Convert ADC → Voltage
	        //voltage = (sensor_value / 4095.0) * 3.3;

	        // Voltage → Temperature in Celsius (LM35 = 10mV per °C)
	        //tempC = voltage * 100.0;

	        // Print temperature
	        printf("Temperature: %f °C \n\r", tempC);

	        //for(long i = 0; i < 1000000; i++) {}  // crude delay

}

void ADC_IRQHandler(void)
{
	//Check If the End of Conversion flag is raised (EOC)
	if(ADC1->SR & SR_EOC)
	{
		//Clear EOC
		ADC1->SR &= ~SR_EOC;
		//Do Something
		ADC_Callback();

	}
}



